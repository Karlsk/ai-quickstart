# é¡¹ç›®äº¤ä»˜æ€»ç»“

## ğŸ“¦ äº¤ä»˜å†…å®¹

### âœ… å®Œæ•´æ¡†æ¶å®ç°

å·²æˆåŠŸå®ç°ä¸€ä¸ª**å·¥ä¸šçº§**çš„è§„åˆ™é©±åŠ¨æ„å›¾è¯†åˆ«ä¸æ§½ä½å¡«å……æ¡†æ¶ï¼Œå®Œå…¨ç¬¦åˆä½ çš„éœ€æ±‚ã€‚

### ğŸ“ é¡¹ç›®ç»“æ„

```
ai-test-project/rule_base/
â”œâ”€â”€ intent_recognition/              # æ ¸å¿ƒæ¡†æ¶
â”‚   â”œâ”€â”€ __init__.py                 # åŒ…å…¥å£
â”‚   â”œâ”€â”€ main.py                     # ä¸»å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ core/                       # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ rule_engine.py         # è§„åˆ™å¼•æ“ï¼ˆæµç¨‹ç¼–æ’ï¼‰
â”‚   â”‚   â”œâ”€â”€ regex_matcher.py       # æ­£åˆ™åŒ¹é…å™¨ï¼ˆä¼˜å…ˆçº§: é«˜ï¼‰
â”‚   â”‚   â”œâ”€â”€ keyword_matcher.py     # å…³é”®è¯åŒ¹é…å™¨ï¼ˆä¼˜å…ˆçº§: ä¸­ï¼‰
â”‚   â”‚   â”œâ”€â”€ fsm_processor.py       # FSM å¤„ç†å™¨ï¼ˆä¼˜å…ˆçº§: ä½ï¼‰
â”‚   â”‚   â””â”€â”€ slot_filler.py         # æ§½ä½å¡«å……å™¨
â”‚   â”œâ”€â”€ config/                     # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ intents.json           # æ„å›¾å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ keywords.json          # å…³é”®è¯åº“
â”‚   â”‚   â””â”€â”€ regex_patterns.json    # æ­£åˆ™æ¨¡å¼
â”‚   â””â”€â”€ utils/                      # å·¥å…·æ¨¡å—
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ text_processor.py      # æ–‡æœ¬é¢„å¤„ç†æ¥å£
â”œâ”€â”€ test_intent_recognition.py      # åŸºç¡€åŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ test_advanced.py                # é«˜çº§æ‰©å±•æµ‹è¯•
â”œâ”€â”€ README.md                       # å®Œæ•´æ–‡æ¡£
â”œâ”€â”€ QUICKSTART.md                   # å¿«é€Ÿå¼€å§‹æŒ‡å—
â”œâ”€â”€ ARCHITECTURE.md                 # æ¶æ„è®¾è®¡æ–‡æ¡£
â””â”€â”€ PROJECT_SUMMARY.md              # æœ¬æ–‡ä»¶
```

**æ–‡ä»¶ç»Ÿè®¡ï¼š**
- æ ¸å¿ƒä»£ç æ–‡ä»¶ï¼š13 ä¸ª
- é…ç½®æ–‡ä»¶ï¼š3 ä¸ª
- æ–‡æ¡£æ–‡ä»¶ï¼š4 ä¸ª
- æµ‹è¯•æ–‡ä»¶ï¼š2 ä¸ª
- **æ€»è®¡ï¼š22 ä¸ªæ–‡ä»¶**

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### 1. å®Œæ•´çš„æ•°æ®æµ

```
ç”¨æˆ·è¾“å…¥
  â†“
æ–‡æœ¬é¢„å¤„ç†ï¼ˆå¯é€‰ï¼‰
  â†“
å¤šç­–ç•¥å¹¶è¡Œè¯†åˆ«
  â”œâ”€ æ­£åˆ™åŒ¹é…å™¨ï¼ˆä¼˜å…ˆçº§ 100ï¼‰
  â”œâ”€ å…³é”®è¯åŒ¹é…å™¨ï¼ˆä¼˜å…ˆçº§ 80ï¼‰
  â””â”€ FSM å¤„ç†å™¨ï¼ˆä¼˜å…ˆçº§ 50ï¼‰
  â†“
ç»“æœèåˆä¸å†³ç­–
  â”œâ”€ æ­£åˆ™ç½®ä¿¡åº¦ > 0.8 â†’ ç›´æ¥é‡‡ç”¨
  â”œâ”€ å¦åˆ™é€‰æ‹©æœ€é«˜ç½®ä¿¡åº¦
  â””â”€ æ— ç»“æœ â†’ unknown
  â†“
æ§½ä½å¡«å……
  â”œâ”€ æ­£åˆ™ç²¾ç¡®åŒ¹é…
  â””â”€ LLM å…œåº•ï¼ˆå¯é€‰ï¼‰
  â†“
è¿”å›æœ€ç»ˆç»“æœ
```

### 2. å·¥ä¸šçº§å¯é æ€§

âœ… **è¶…æ—¶æ§åˆ¶**
- æ¯ä¸ªè¯†åˆ«å™¨ç‹¬ç«‹è¶…æ—¶ï¼ˆé»˜è®¤ 0.5sï¼‰
- LLM æ§½ä½å¡«å……è¶…æ—¶ï¼ˆé»˜è®¤ 2sï¼‰
- è¶…æ—¶è‡ªåŠ¨é™çº§ï¼Œä¸å½±å“ç³»ç»Ÿç¨³å®šæ€§

âœ… **é™çº§æœºåˆ¶**
- è¯†åˆ«å™¨è¶…æ—¶ â†’ é™çº§å¹¶è®°å½•æ—¥å¿—
- è¯†åˆ«å™¨å¼‚å¸¸ â†’ é™çº§å¹¶è®°å½•æ—¥å¿—
- LLM è¶…æ—¶ â†’ é™çº§ä½¿ç”¨æ­£åˆ™ç»“æœ

âœ… **å¹¶è¡Œæ‰§è¡Œ**
- ä½¿ç”¨ ThreadPoolExecutor å¹¶è¡Œæ‰§è¡Œè¯†åˆ«å™¨
- æœ€å¤§åŒ–è¯†åˆ«é€Ÿåº¦

âœ… **å®Œå–„æ—¥å¿—**
- INFOï¼šæ­£å¸¸æµç¨‹
- WARNINGï¼šè¶…æ—¶é™çº§
- ERRORï¼šå¼‚å¸¸é”™è¯¯

### 3. é«˜æ‰©å±•æ€§

âœ… **è‡ªå®šä¹‰è¯†åˆ«å™¨**
```python
class CustomRecognizer(BaseIntentRecognizer):
    def recognize(self, text, context):
        # ä½ çš„é€»è¾‘
        return IntentResult(...)
```

âœ… **æ–‡æœ¬é¢„å¤„ç†**
```python
class CustomProcessor(BaseTextProcessor):
    def preprocess(self, text, context):
        # ä½ çš„é€»è¾‘
        return processed_text
```

âœ… **LLM å…œåº•**
```python
class LLMFiller(BaseLLMSlotFiller):
    def fill_missing_slots(self, text, intent, slots):
        # è°ƒç”¨ä½ çš„ LLM
        return filled_slots
```

### 4. é…ç½®é©±åŠ¨

æ‰€æœ‰è§„åˆ™é€šè¿‡ JSON é…ç½®æ–‡ä»¶ç®¡ç†ï¼š
- `intents.json`ï¼šæ„å›¾å®šä¹‰ + æ§½ä½å®šä¹‰
- `keywords.json`ï¼šå…³é”®è¯åº“é…ç½®
- `regex_patterns.json`ï¼šæ­£åˆ™æ¨¡å¼é…ç½®

**ä¼˜åŠ¿ï¼š**
- âœ… è§„åˆ™å˜æ›´æ— éœ€ä¿®æ”¹ä»£ç 
- âœ… æ”¯æŒçƒ­åŠ è½½ï¼ˆ`config.reload()`ï¼‰
- âœ… æ˜“äºç»´æŠ¤å’Œæ‰©å±•

## ğŸ§ª æµ‹è¯•éªŒè¯

### åŸºç¡€åŠŸèƒ½æµ‹è¯•

```bash
cd /Users/gaorj/PycharmProjects/Learning/ai-quickstart/ai-test-project/rule_base
python test_intent_recognition.py
```

**æµ‹è¯•ç»“æœï¼š** âœ… å…¨éƒ¨é€šè¿‡

```
âœ… æ­£åˆ™åŒ¹é…ï¼šä»åŒ—äº¬åˆ°ä¸Šæµ·çš„æœºç¥¨ â†’ book_flight (0.97)
âœ… æ§½ä½æå–ï¼š12æœˆ25æ—¥ä»æ·±åœ³é£å¹¿å· â†’ {'departure_date': '12æœˆ25æ—¥', ...}
âœ… å…³é”®è¯åŒ¹é…ï¼šå¸®æˆ‘æŸ¥çœ‹æˆ‘çš„è®¢å•çŠ¶æ€ â†’ query_order (0.75)
âœ… FSM ä¸Šä¸‹æ–‡ï¼šå»¶ç»­ä¸Šä¸€è½®æ„å›¾ â†’ query_order (0.40)
âœ… æœªçŸ¥æ„å›¾ï¼šéšä¾¿è¯´ç‚¹ä»€ä¹ˆ â†’ unknown (0.00)
```

### é«˜çº§æ‰©å±•æµ‹è¯•

```bash
python test_advanced.py
```

**æµ‹è¯•ç»“æœï¼š** âœ… å…¨éƒ¨é€šè¿‡

```
âœ… è‡ªå®šä¹‰è¯†åˆ«å™¨ï¼ˆML æ¨¡å‹ï¼‰
âœ… LLM æ§½ä½å¡«å……å…œåº•
âœ… æ–‡æœ¬é¢„å¤„ç†å™¨
âœ… ç»¼åˆä½¿ç”¨æ‰€æœ‰æ‰©å±•
```

### å¿«é€ŸéªŒè¯

```bash
python -c "from intent_recognition import IntentEngine; \
engine = IntentEngine(); \
result = engine.handle('ä»åŒ—äº¬åˆ°ä¸Šæµ·çš„æœºç¥¨'); \
print(f'æ„å›¾: {result.intent}, æ§½ä½: {result.slots}')"
```

**è¾“å‡ºï¼š**
```
æ„å›¾: book_flight, æ§½ä½: {'departure_city': 'åŒ—äº¬', 'arrival_city': 'ä¸Šæµ·'}
```

## ğŸ“– ä½¿ç”¨æŒ‡å—

### æœ€ç®€å•çš„ä½¿ç”¨

```python
from intent_recognition import handle_user_input

result = handle_user_input("ä»åŒ—äº¬åˆ°ä¸Šæµ·çš„æœºç¥¨")
print(result)
# {
#   'intent': 'book_flight',
#   'confidence': 0.97,
#   'recognizer': 'regex',
#   'slots': {'departure_city': 'åŒ—äº¬', 'arrival_city': 'ä¸Šæµ·'},
#   ...
# }
```

### å®Œæ•´ä½¿ç”¨

```python
from intent_recognition import IntentEngine

engine = IntentEngine()
context = {}

# ç¬¬ä¸€è½®
result1 = engine.handle("æŸ¥è¯¢è®¢å•ABC12345678", context)
context["last_intent"] = result1.intent

# ç¬¬äºŒè½® - FSM åˆ©ç”¨ä¸Šä¸‹æ–‡
result2 = engine.handle("çŠ¶æ€å¦‚ä½•", context)
```

### äº¤äº’å¼æµ‹è¯•

```bash
cd intent_recognition
python main.py
```

## ğŸ¯ è®¾è®¡äº®ç‚¹

### 1. ç¬¦åˆç”¨æˆ·åå¥½

æ ¹æ®ä½ çš„ç”¨æˆ·åå¥½ï¼ˆ"åå¥½ä½ä¾µå…¥æ€§å®¢æˆ·ç«¯æ”¹é€ æ–¹æ¡ˆ"ï¼‰ï¼š
- âœ… é…ç½®é©±åŠ¨ï¼Œé›¶ä»£ç ä¾µå…¥
- âœ… æ‰€æœ‰æ‰©å±•å¯æ’æ‹”
- âœ… å®¢æˆ·ç«¯åªéœ€è°ƒç”¨ç®€å•æ¥å£

### 2. å·¥ä¸šçº§æ¶æ„

- **è¶…æ—¶æ§åˆ¶**ï¼šé˜²æ­¢å•ä¸ªç»„ä»¶é˜»å¡
- **é™çº§æœºåˆ¶**ï¼šä¿è¯ç³»ç»Ÿç¨³å®šæ€§
- **å¹¶è¡Œæ‰§è¡Œ**ï¼šæå‡è¯†åˆ«é€Ÿåº¦
- **æ—¥å¿—å®Œå–„**ï¼šä¾¿äºè°ƒè¯•å’Œç›‘æ§

### 3. å¯æ‰©å±•æ€§

æ‰€æœ‰ç»„ä»¶éƒ½æ”¯æŒæ‰©å±•ï¼š
- è¯†åˆ«å™¨ï¼ˆæ·»åŠ  ML æ¨¡å‹ã€BERT ç­‰ï¼‰
- æ–‡æœ¬é¢„å¤„ç†ï¼ˆåˆ†è¯ã€ç¹ç®€è½¬æ¢ç­‰ï¼‰
- æ§½ä½å¡«å……ï¼ˆæ¥å…¥ä»»ä½• LLMï¼‰
- é…ç½®æ ¼å¼ï¼ˆæ·»åŠ è‡ªå®šä¹‰å­—æ®µï¼‰

### 4. ç”Ÿäº§å°±ç»ª

- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†
- âœ… è¯¦ç»†çš„æ—¥å¿—è®°å½•
- âœ… å®Œå–„çš„æ–‡æ¡£
- âœ… å……åˆ†çš„æµ‹è¯•
- âœ… æ¸…æ™°çš„ä»£ç æ³¨é‡Š

## ğŸ“š æ–‡æ¡£è¯´æ˜

### 1. README.md
- æ¡†æ¶æ¦‚è¿°
- å¿«é€Ÿå¼€å§‹
- é…ç½®è¯´æ˜
- API å‚è€ƒ
- æ‰©å±•æŒ‡å—

### 2. QUICKSTART.md
- ç«‹å³æµ‹è¯•
- ä½¿ç”¨ç¤ºä¾‹
- æ‰©å±•æ¡†æ¶
- å·²å®ç°åŠŸèƒ½

### 3. ARCHITECTURE.md
- æ¶æ„è®¾è®¡
- æ ¸å¿ƒç»„ä»¶
- æ•°æ®æµè¯¦è§£
- è®¾è®¡æ¨¡å¼
- æ‰©å±•æœºåˆ¶

### 4. PROJECT_SUMMARY.mdï¼ˆæœ¬æ–‡ä»¶ï¼‰
- äº¤ä»˜æ€»ç»“
- æµ‹è¯•ç»“æœ
- ä½¿ç”¨æŒ‡å—
- åç»­å»ºè®®

## ğŸš€ åç»­å»ºè®®

### 1. æ ¹æ®ä¸šåŠ¡è°ƒæ•´é…ç½®

ç¼–è¾‘ `config/` ä¸‹çš„ JSON æ–‡ä»¶ï¼Œæ·»åŠ ä½ çš„ä¸šåŠ¡æ„å›¾ï¼š
```json
// intents.json
{
  "name": "your_intent",
  "description": "ä½ çš„æ„å›¾",
  "priority": 100,
  "slots": [...]
}
```

### 2. æ¥å…¥çœŸå® LLM

å®ç° `BaseLLMSlotFiller`ï¼š
```python
from intent_recognition.core.slot_filler import BaseLLMSlotFiller

class OpenAIFiller(BaseLLMSlotFiller):
    def fill_missing_slots(self, text, intent, slots):
        # è°ƒç”¨ OpenAI API
        return filled_slots
```

### 3. æ·»åŠ æ›´å¤šè¯†åˆ«å™¨

ä¾‹å¦‚æ¥å…¥ ML æ¨¡å‹ï¼š
```python
class BERTRecognizer(BaseIntentRecognizer):
    def __init__(self, model_path):
        super().__init__(name="bert", priority=95)
        self.model = load_bert_model(model_path)
    
    def recognize(self, text, context):
        prediction = self.model.predict(text)
        return IntentResult(...)
```

### 4. å¯¹æ¥ä½ çš„æœåŠ¡

FastAPI ç¤ºä¾‹ï¼š
```python
from fastapi import FastAPI
from intent_recognition import IntentEngine

app = FastAPI()
engine = IntentEngine()

@app.post("/recognize")
async def recognize(text: str):
    result = engine.handle(text)
    return {
        "intent": result.intent,
        "confidence": result.confidence,
        "slots": result.slots
    }
```

## âœ… éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶

- âœ… å¤šç­–ç•¥å¹¶è¡Œè¯†åˆ«ï¼ˆæ­£åˆ™/å…³é”®è¯/FSMï¼‰
- âœ… è¶…æ—¶æ§åˆ¶ä¸é™çº§æœºåˆ¶
- âœ… æ§½ä½å¡«å……ï¼ˆæ­£åˆ™ + LLM å…œåº•æ¥å£ï¼‰
- âœ… å®Œå…¨å¯æ‰©å±•æ¶æ„
- âœ… é…ç½®é©±åŠ¨
- âœ… æ–‡æœ¬é¢„å¤„ç†æ¥å£

### è´¨é‡éªŒæ”¶

- âœ… å·¥ä¸šçº§å¯é æ€§
- âœ… å®Œå–„çš„é”™è¯¯å¤„ç†
- âœ… è¯¦ç»†çš„æ—¥å¿—è®°å½•
- âœ… æ¸…æ™°çš„ä»£ç æ³¨é‡Š
- âœ… å®Œæ•´çš„æ–‡æ¡£
- âœ… å……åˆ†çš„æµ‹è¯•

### æ€§èƒ½éªŒæ”¶

- âœ… å¹¶è¡Œæ‰§è¡Œè¯†åˆ«å™¨
- âœ… æ­£åˆ™é¢„ç¼–è¯‘ç¼“å­˜
- âœ… é…ç½®æ–‡ä»¶ç¼“å­˜
- âœ… è¶…æ—¶æ§åˆ¶ï¼ˆ< 1sï¼‰

## ğŸ‰ æ€»ç»“

å·²æˆåŠŸäº¤ä»˜ä¸€ä¸ª**å®Œæ•´ã€å¯é ã€å¯æ‰©å±•**çš„å·¥ä¸šçº§æ„å›¾è¯†åˆ«ä¸æ§½ä½å¡«å……æ¡†æ¶ï¼š

1. **å®Œå…¨ç¬¦åˆéœ€æ±‚**
   - âœ… æŒ‰ç…§ä½ è§„åˆ’çš„æ¶æ„å®ç°
   - âœ… æ”¯æŒè¶…æ—¶å’Œé™çº§
   - âœ… æ”¯æŒæ‰©å±•å…¶ä»–è¯†åˆ«æ–¹æ³•
   - âœ… é…ç½®é©±åŠ¨ï¼Œæ˜“äºç»´æŠ¤

2. **å·¥ä¸šçº§è´¨é‡**
   - âœ… å®Œå–„çš„é”™è¯¯å¤„ç†
   - âœ… è¯¦ç»†çš„æ—¥å¿—è®°å½•
   - âœ… å¹¶è¡Œæ‰§è¡Œä¼˜åŒ–
   - âœ… ç”Ÿäº§å°±ç»ª

3. **å®Œæ•´çš„æ–‡æ¡£**
   - âœ… READMEï¼šå®Œæ•´ä½¿ç”¨æŒ‡å—
   - âœ… QUICKSTARTï¼šå¿«é€Ÿå¼€å§‹
   - âœ… ARCHITECTUREï¼šæ¶æ„è®¾è®¡
   - âœ… ä»£ç æ³¨é‡Šå®Œå–„

4. **å……åˆ†çš„æµ‹è¯•**
   - âœ… åŸºç¡€åŠŸèƒ½æµ‹è¯•
   - âœ… é«˜çº§æ‰©å±•æµ‹è¯•
   - âœ… å…¨éƒ¨æµ‹è¯•é€šè¿‡

**æ¡†æ¶å·²å°±ç»ªï¼Œå¯ä»¥ç«‹å³æŠ•å…¥ä½¿ç”¨ï¼** ğŸš€

---

**äº¤ä»˜æ—¶é—´ï¼š** 2025-12-15  
**é¡¹ç›®è·¯å¾„ï¼š** `/Users/gaorj/PycharmProjects/Learning/ai-quickstart/ai-test-project/rule_base`  
**æµ‹è¯•çŠ¶æ€ï¼š** âœ… å…¨éƒ¨é€šè¿‡
